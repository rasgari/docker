# security ESXI

1) ูุงฺฏ ุงุตู ุจุฑุง ุชุดุฎุต ุชุบุฑ ูพุณูุฑุฏ ุฏุฑ ESXi

ุฏุฑ ESXi ุชุบุฑ ุฑูุฒ ูุนูููุงู ุฏุฑ ุงู ูุงูโูุง ุซุจุช ูโุดูุฏ:
```
๐ /var/log/hostd.log
```
ุงู ูููโุชุฑู ูุงฺฏ ุงุณุช.

ุฌุณุชุฌู ฺฉูุฏูุงฺู:
```
password
passwd
user
Authentication
SetUserPassword
```

ููููู ูุงฺฏ ุชุบุฑ ูพุณูุฑุฏ:
```
UserAccount: password changed for user root
```

ู ูุนูููุงู ููุฑุงูุด IP ูโุขุฏ:
```
[originator@6876 sub=Vimsvc.ha-eventmgr] Event 109 : User root@10.10.10.25 changed password

๐ /var/log/vmkernel.log
```
ฺฏุงู ุชุบุฑุงุช ุงููุช ู ุฑูุฏุงุฏูุง ุญุณุงุณ ุงูุฌุง ูู ูโุขุฏ.
```
๐ /var/log/vobd.log
```
ุดุงูู Alertโูุง ุงููุช ู ูุฏุฑุช.

โ 2) ุจุฑุฑุณ ูุงฺฏ ูุงฺฏูโูุง (ุจุฑุง ููู IP)

ุจุฑุง ุงูฺฉู ุจุฏุงูู ฺู IPโุง ูุงุฑุฏ ุดุฏู ู ฺู ุฒูุงู:
```
๐ /var/log/auth.log (ุฏุฑ ูุณุฎูโูุง ุฌุฏุฏ)
```
ุง
```
๐ /var/log/hostd.log
```
ุฌุณุชุฌู:
```
login
successful
failed
root
Accepted
```

ููููู:
```
Login by root from 192.168.1.105
```
๐ 3) ุงุจุฒุงุฑ ูุงุฑูุฒฺฉ ุจุฑุง ุชุญูู ุฎูุฏฺฉุงุฑ ูุงฺฏ ESXi
1) Splunk (ูุณุฎู ุฑุงฺฏุงู ฺฉุงูุณุช)

ูโุชูุงู ูุงฺฏ ESXi ุฑุง ุฏุงุฎู Splunk ุงููพูุฑุช ฺฉู ู ฺฏุฒุงุฑุด ุจฺฏุฑ:

ฺู ุฒูุงู ุฑูุฒ ุชุบุฑ ฺฉุฑุฏู

ฺู IP ูุงุฑุฏ ุดุฏู

ฺู ูุฒุฑ ุนููุงุช ุงูุฌุงู ุฏุงุฏู

2) ELK Stack (Elasticsearch + Logstash + Kibana)

ุจูโุฎุตูุต ุงฺฏุฑ ูุจูุงู ELK ุฏุงุฑุ ููุท ูุงฺฏโูุง ุฑุง import ฺฉู.

3) Log Parser Studio (ูุงฺฉุฑูุณุงูุช)

ุงฺฏุฑ ูุงฺฏโูุง ุฑุง ุฑู ููุฏูุฒ ฺฉุดุฏูโุงุ ุงู ุงุจุฒุงุฑ ุจุฑุง ุชุญูู ฺฉูุฏูุงฺูโุง ุนุงู ุงุณุช.

4) ุงุจุฒุงุฑูุง ูุงุฑูุฒฺฉ:

Autopsy

Sleuth Kit

ุงูโูุง ุณุงุฎุชุงุฑ ูุงูโูุง ุฑุง ุงุณฺฉู ูโฺฉููุฏ ู ุจุฑุง ุชุญูู ูุงูโูุง ูุงฺฏ ุขุฑุดู ููุงุณุจโุงูุฏ.

๐ง 4) ุฏุณุชูุฑูุง ูุณุชูู ุจุฑุง ุฌุณุชุฌู ุชุบุฑ ูพุณูุฑุฏ
ESXi Shell ุง SSH ูุงุฑุฏ ุดู:

ุฌุณุชุฌู ุฑูุฏุงุฏ ุชุบุฑ ูพุณูุฑุฏ:
```
grep -i "password" /var/log/hostd.log
```

ุฌุณุชุฌู IP ุชุบุฑโุฏููุฏู:

grep -i "changed" /var/log/hostd.log


ุฌุณุชุฌู ุชูุงู ูุงฺฏโูุง login:

grep -i "Login" /var/log/hostd.log


ุฌุณุชุฌู IPูุง ูุดฺฉูฺฉ:

grep -Eo "([0-9]{1,3}\.){3}[0-9]{1,3}" /var/log/hostd.log | sort -u

๐ ุงฺฏุฑ ูุงฺฏ rotate ุดุฏู ู ุฏุฑ hostd.1.gz ุงุณุช:
zcat /var/log/hostd.1.gz | grep -i "password"

๐ฏ ุงฺฏุฑ ุจุฎูุงู ฺฉ ุงุจุฒุงุฑ full forensic ฺฉู ุงุชููุงุช log ESXi ุฑุง ุชุญูู ฺฉูุฏ

ุจูุชุฑู ฺฏุฒููโูุง:

๐ Velociraptor (ุชูุตูโุดุฏู ุจุฑุง ูุงุฑูุฒฺฉ ูุงูุน)

ูโุชูุงูุฏ:

ุชุญูู ฺฉุงูู ูุงฺฏ ESXi

ฺฉุดู ูุงฺฏู

ฺฉุดู ุชุบุฑุงุช Credential

ุณุงุฎุช ฺฏุฒุงุฑุด ูุงุจู ุงุฑุงุฆู

๐ Graylog

ุจุฑุง ุฏุฏู ุชุบุฑ ูพุณูุฑุฏุ ูุงฺฏู ู IPโูุง ุจุณุงุฑ ุนุงู ุงุณุช.
